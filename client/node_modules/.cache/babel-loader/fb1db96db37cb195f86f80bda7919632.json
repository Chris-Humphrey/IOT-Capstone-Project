{"ast":null,"code":"import { AUTH_USER, AUTH_ERROR, AUTH_SIGNOUT, COL_ADD_PLANT, DISPLAY_COL_ITEMS, COL_REMOVE_PLANT, WISH_ADD_PLANT } from './types';\nimport axios from 'axios'; // REFACTORING SIGNUP\n\nlet decodeToken = token => {\n  let split_token = token.split('.');\n  let token_payload = split_token[1];\n  let decoded_token_string = atob(token_payload);\n  let decoded_token = JSON.parse(decoded_token_string); // localStorage.setItem('user_id', decoded_token.sub);\n  // localStorage.setItem('user_name', decoded_token.user_name)\n  // console.log(`local storage user ID: ${localStorage.user_id}`)\n  // console.log(`local Storage user name: ${localStorage.user_name}`)\n};\n\nexport const signup = (formProps, callback) => async dispatch => {\n  try {\n    let response = await axios.post('/signup', formProps);\n    decodeToken(response.data.token); //dispatch\n\n    dispatch({\n      type: AUTH_USER,\n      payload: response.data.token,\n      isLoggedIn: true,\n      username: formProps.username\n    });\n    localStorage.setItem('token', response.data.token);\n    callback();\n  } catch (e) {\n    dispatch({\n      type: AUTH_ERROR,\n      payload: 'That email is already in use...'\n    });\n  }\n};\nexport const signin = (formProps, callback) => async dispatch => {\n  try {\n    let response = await axios.post('/signin', formProps);\n    decodeToken(response.data.token);\n    console.log('signin form props');\n    console.log(localStorage.user_name);\n    dispatch({\n      type: AUTH_USER,\n      payload: response.data.token,\n      isLoggedIn: true,\n      username: localStorage.user_name\n    });\n    localStorage.setItem('token', response.data.token);\n    callback();\n  } catch (e) {\n    dispatch({\n      type: AUTH_ERROR,\n      payload: 'The email or password is incorrect...'\n    });\n  }\n};\nexport const signout = () => {\n  localStorage.clear();\n  return {\n    type: AUTH_SIGNOUT,\n    payload: '',\n    isLoggedIn: false\n  };\n}; //Add/remove from collection:\n\nexport const addToCollectionDb = plant => async dispatch => {\n  // try{\n  // console.log(`indide addtocollectionDB plant ID ${plant.item.id}`)\n  let response = await axios.post('/colAdd', {\n    plant_id: plant.id,\n    user_id: localStorage.user_id\n  });\n  console.log(\"add to collection axios response: \".concat(response)); //dispatch\n\n  dispatch({\n    type: COL_ADD_PLANT,\n    payload: plant\n  });\n  localStorage.setItem('plant_id', response.data.plant_id);\n  console.log(\"after setItem localstorage \".concat(response.data.plant_id));\n};\nexport const displayCollectionDb = () => async dispatch => {\n  let response = await axios.post('/collection', {\n    user_id: localStorage.user_id\n  });\n  console.log('response');\n  console.log(response.data);\n  dispatch({\n    type: DISPLAY_COL_ITEMS,\n    payload: response.data\n  });\n};\nexport const removeFromCollectionDb = plant => async dispatch => {\n  let response = await axios.post('/colRemove', {\n    user_id: localStorage.user_id,\n    plant_id: plant.renderPlant.plant_id\n  });\n  console.log('action');\n  console.log(plant.renderPlant);\n  dispatch({\n    type: COL_REMOVE_PLANT,\n    payload: plant.renderPlant\n  }); // localStorage.removeItem('plant_id')\n};\nexport const addToWishlistDb = plant => async dispatch => {\n  let response = await axios.post('/wishAdd', {\n    user_id: localStorage.user_id,\n    plant_id: plant.id\n  });\n  console.log(\"add wishlist axios response \".concat(response));\n  console.log(\"payload plant.item \".concat(plant.name));\n  dispatch({\n    type: WISH_ADD_PLANT,\n    payload: plant\n  });\n};","map":{"version":3,"sources":["/Users/volleyball_chik_100/DigitalCrafts/Projects/IOT-Practice-2/gardenia2/client/src/actions/index.js"],"names":["AUTH_USER","AUTH_ERROR","AUTH_SIGNOUT","COL_ADD_PLANT","DISPLAY_COL_ITEMS","COL_REMOVE_PLANT","WISH_ADD_PLANT","axios","decodeToken","token","split_token","split","token_payload","decoded_token_string","atob","decoded_token","JSON","parse","signup","formProps","callback","dispatch","response","post","data","type","payload","isLoggedIn","username","localStorage","setItem","e","signin","console","log","user_name","signout","clear","addToCollectionDb","plant","plant_id","id","user_id","displayCollectionDb","removeFromCollectionDb","renderPlant","addToWishlistDb","name"],"mappings":"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","sourcesContent":["import { AUTH_USER, AUTH_ERROR, AUTH_SIGNOUT, COL_ADD_PLANT, DISPLAY_COL_ITEMS, COL_REMOVE_PLANT, WISH_ADD_PLANT} from './types';\nimport axios from 'axios';\n\n\n// REFACTORING SIGNUP\n\nlet decodeToken = (token)=>{\n    let split_token = token.split('.')\n    let token_payload = split_token[1];\n    let decoded_token_string = atob(token_payload);\n    let decoded_token = JSON.parse(decoded_token_string)\n    // localStorage.setItem('user_id', decoded_token.sub);\n    // localStorage.setItem('user_name', decoded_token.user_name)\n    // console.log(`local storage user ID: ${localStorage.user_id}`)\n    // console.log(`local Storage user name: ${localStorage.user_name}`)\n}\n\nexport const signup = (formProps, callback) => async dispatch =>{\n\n    try{\n        let response = await axios.post('/signup', formProps);\n        decodeToken(response.data.token)\n\n        //dispatch\n\n        dispatch({type: AUTH_USER, payload: response.data.token, isLoggedIn: true, username: formProps.username});\n        localStorage.setItem('token', response.data.token);\n        callback();\n    }\n    catch(e){\n        dispatch({type: AUTH_ERROR, payload: 'That email is already in use...'})\n    }\n};\n\nexport const signin = (formProps, callback) => async dispatch => {\n\n    try {\n        let response = await axios.post('/signin', formProps);\n        decodeToken(response.data.token)\n\n        console.log('signin form props')\n        console.log(localStorage.user_name)\n        \n        dispatch({type: AUTH_USER, payload: response.data.token, isLoggedIn: true, username: localStorage.user_name});\n\n        localStorage.setItem('token', response.data.token);\n        callback();\n    }\n    catch(e){\n        dispatch({type: AUTH_ERROR, payload: 'The email or password is incorrect...'})\n    }\n\n}\n\nexport const signout = () => {\n\n    localStorage.clear()\n    return {\n        type: AUTH_SIGNOUT,\n        payload: '',\n        isLoggedIn: false\n    }\n}\n\n//Add/remove from collection:\nexport const addToCollectionDb = (plant) => async dispatch =>{\n\n    // try{\n        // console.log(`indide addtocollectionDB plant ID ${plant.item.id}`)\n        let response = await axios.post('/colAdd', \n        {plant_id : plant.id, user_id: localStorage.user_id})\n\n    console.log(`add to collection axios response: ${response}`)\n\n    //dispatch\n\n    dispatch({type: COL_ADD_PLANT, \n        payload: plant});\n\n    localStorage.setItem('plant_id', response.data.plant_id);\n    console.log(`after setItem localstorage ${response.data.plant_id}`) \n}\n\nexport const displayCollectionDb = () => async dispatch => {\n    let response = await axios.post('/collection', {user_id: localStorage.user_id})\n    console.log('response')\n    console.log(response.data)\n    dispatch({type: DISPLAY_COL_ITEMS, payload: response.data});\n}\n\nexport const removeFromCollectionDb = (plant) => async dispatch => {\n    \n    let response = await axios.post('/colRemove', {user_id: localStorage.user_id, plant_id: plant.renderPlant.plant_id})\n    console.log('action')\n    console.log(plant.renderPlant)\n    dispatch({type: COL_REMOVE_PLANT, payload: plant.renderPlant})\n    // localStorage.removeItem('plant_id')\n}\n\nexport const addToWishlistDb = (plant) => async dispatch => {\n    let response = await axios.post('/wishAdd', {user_id: localStorage.user_id, plant_id: plant.id})\n    console.log(`add wishlist axios response ${response}`)\n    console.log(`payload plant.item ${plant.name}`)\n    dispatch({type: WISH_ADD_PLANT, payload: plant})\n}\n\n\n"]},"metadata":{},"sourceType":"module"}